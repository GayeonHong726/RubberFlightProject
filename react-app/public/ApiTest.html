<!DOCTYPE html>
<html>
<head>
  <title>Hello Photorealistic 3D Maps in Maps JavaScript</title>
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #map {
      height: 100%;
      width: 100%;
    }
  </style>
</head>
<body>
  <gmp-map-3d id="map" center="37.841157, -122.551679" tilt="67.5"></gmp-map-3d>
  <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAUE-qzPob_mpqr2KUELbQjHwuRe8-CUXc&v=alpha&libraries=maps3d" onload="initMap()"></script>
  <script>
    let map, marker;

    function initMap() {
      map = document.getElementById("map");

      // 초기 마커 설정
      marker = new google.maps.Marker({
        position: { lat: 37.841157, lng: -122.551679 },
        map: new google.maps.Map(map),
        title: "Hello World!",
      });
    }

    window.addEventListener('message', (event) => {
      if (event.data.type === 'UPDATE_COORDINATES') {
        const { lat, lng } = event.data;
        const newCenter = { lat: parseFloat(lat), lng: parseFloat(lng) };

        // 지도 중심 업데이트
        map.setAttribute('center', `${newCenter.lat}, ${newCenter.lng}`);

        // 마커 위치 업데이트
        marker.setPosition(newCenter);
      }
    });
  </script>
</body>
</html>
